%!PS-Adobe-3.0
%%Creator: groff version 1.22.2
%%CreationDate: Sat Feb 19 18:25:15 2022
%%Title: asg4-cxi-cxid-code.ps
%%BoundingBox: 0 0 612 792
%%DocumentNeededResources: font Courier
%%+ font Courier-Bold
%%+ font NewCenturySchlbk-Bold
%%+ font NewCenturySchlbk-Roman
%%+ font NewCenturySchlbk-BoldItalic
%%+ font NewCenturySchlbk-Italic
%%DocumentSuppliedResources: procset grops 1.22 2
%%+ font Courier-Elite-Bold
%%+ font Courier-Elite
%%Pages: 6
%%PageOrder: Ascend
%%DocumentMedia: Default 612 792 0 () ()
%%Orientation: Portrait
%%EndComments
%%BeginDefaults
%%PageMedia: Default
%%EndDefaults
%%BeginProlog
%%BeginResource: procset grops 1.22 2
/setpacking where{
pop
currentpacking
true setpacking
}if
/grops 120 dict dup begin
/SC 32 def
/A/show load def
/B{0 SC 3 -1 roll widthshow}bind def
/C{0 exch ashow}bind def
/D{0 exch 0 SC 5 2 roll awidthshow}bind def
/E{0 rmoveto show}bind def
/F{0 rmoveto 0 SC 3 -1 roll widthshow}bind def
/G{0 rmoveto 0 exch ashow}bind def
/H{0 rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/I{0 exch rmoveto show}bind def
/J{0 exch rmoveto 0 SC 3 -1 roll widthshow}bind def
/K{0 exch rmoveto 0 exch ashow}bind def
/L{0 exch rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/M{rmoveto show}bind def
/N{rmoveto 0 SC 3 -1 roll widthshow}bind def
/O{rmoveto 0 exch ashow}bind def
/P{rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/Q{moveto show}bind def
/R{moveto 0 SC 3 -1 roll widthshow}bind def
/S{moveto 0 exch ashow}bind def
/T{moveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/SF{
findfont exch
[exch dup 0 exch 0 exch neg 0 0]makefont
dup setfont
[exch/setfont cvx]cvx bind def
}bind def
/MF{
findfont
[5 2 roll
0 3 1 roll
neg 0 0]makefont
dup setfont
[exch/setfont cvx]cvx bind def
}bind def
/level0 0 def
/RES 0 def
/PL 0 def
/LS 0 def
/MANUAL{
statusdict begin/manualfeed true store end
}bind def
/PLG{
gsave newpath clippath pathbbox grestore
exch pop add exch pop
}bind def
/BP{
/level0 save def
1 setlinecap
1 setlinejoin
DEFS/BPhook known{DEFS begin BPhook end}if
72 RES div dup scale
LS{
90 rotate
}{
0 PL translate
}ifelse
1 -1 scale
}bind def
/EP{
level0 restore
showpage
}def
/DA{
newpath arcn stroke
}bind def
/SN{
transform
.25 sub exch .25 sub exch
round .25 add exch round .25 add exch
itransform
}bind def
/DL{
SN
moveto
SN
lineto stroke
}bind def
/DC{
newpath 0 360 arc closepath
}bind def
/TM matrix def
/DE{
TM currentmatrix pop
translate scale newpath 0 0 .5 0 360 arc closepath
TM setmatrix
}bind def
/RC/rcurveto load def
/RL/rlineto load def
/ST/stroke load def
/MT/moveto load def
/CL/closepath load def
/Fr{
setrgbcolor fill
}bind def
/setcmykcolor where{
pop
/Fk{
setcmykcolor fill
}bind def
}if
/Fg{
setgray fill
}bind def
/FL/fill load def
/LW/setlinewidth load def
/Cr/setrgbcolor load def
/setcmykcolor where{
pop
/Ck/setcmykcolor load def
}if
/Cg/setgray load def
/RE{
findfont
dup maxlength 1 index/FontName known not{1 add}if dict begin
{
1 index/FID ne
2 index/UniqueID ne
and
{def}{pop pop}ifelse
}forall
/Encoding exch def
dup/FontName exch def
currentdict end definefont pop
}bind def
/DEFS 0 def
/EBEGIN{
moveto
DEFS begin
}bind def
/EEND/end load def
/CNT 0 def
/level1 0 def
/PBEGIN{
/level1 save def
translate
div 3 1 roll div exch scale
neg exch neg exch translate
0 setgray
0 setlinecap
1 setlinewidth
0 setlinejoin
10 setmiterlimit
[]0 setdash
/setstrokeadjust where{
pop
false setstrokeadjust
}if
/setoverprint where{
pop
false setoverprint
}if
newpath
/CNT countdictstack def
userdict begin
/showpage{}def
/setpagedevice{}def
mark
}bind def
/PEND{
cleartomark
countdictstack CNT sub{end}repeat
level1 restore
}bind def
end def
/setpacking where{
pop
setpacking
}if
%%EndResource
%%BeginFeature: *PageSize Default
<< /PageSize [ 612 792 ] /ImagingBBox null >> setpagedevice
%%EndFeature
%%IncludeResource: font Courier
%%IncludeResource: font Courier-Bold
%%IncludeResource: font NewCenturySchlbk-Bold
%%IncludeResource: font NewCenturySchlbk-Roman
%%IncludeResource: font NewCenturySchlbk-BoldItalic
%%IncludeResource: font NewCenturySchlbk-Italic
%%BeginResource: font Courier-Elite-Bold
%%DocumentNeededResources: font Courier-Bold
/MakeTransformedFont{
findfont dup maxlength dict begin
{
exch dup dup/FID ne exch/UniqueID ne and{
exch def
}{
pop pop
}ifelse
}forall
/FontBBox
currentdict/FontBBox get
4 array copy def
FontBBox aload pop
4 index transform 4 2 roll
4 index transform 4 2 roll
FontBBox astore pop
FontMatrix exch matrix concatmatrix
/FontMatrix exch def
dup/FontName exch def
currentdict end
definefont pop
}bind def
/Courier-Elite-Bold
[ .833333333 0 0 1 0 0 ]
/Courier-Bold
MakeTransformedFont
%%EndResource
%%BeginResource: font Courier-Elite
%%DocumentNeededResources: font Courier
/MakeTransformedFont{
findfont dup maxlength dict begin
{
exch dup dup/FID ne exch/UniqueID ne and{
exch def
}{
pop pop
}ifelse
}forall
/FontBBox
currentdict/FontBBox get
4 array copy def
FontBBox aload pop
4 index transform 4 2 roll
4 index transform 4 2 roll
FontBBox astore pop
FontMatrix exch matrix concatmatrix
/FontMatrix exch def
dup/FontName exch def
currentdict end
definefont pop
}bind def
/Courier-Elite
[ .833333333 0 0 1 0 0 ]
/Courier
MakeTransformedFont
%%EndResource
grops begin/DEFS 1 dict def DEFS begin/u{.001 mul}bind def end/RES 72
def/PL 792 def/LS false def/ENC0[/asciicircum/asciitilde/Scaron/Zcaron
/scaron/zcaron/Ydieresis/trademark/quotesingle/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/space/exclam/quotedbl/numbersign/dollar/percent
/ampersand/quoteright/parenleft/parenright/asterisk/plus/comma/hyphen
/period/slash/zero/one/two/three/four/five/six/seven/eight/nine/colon
/semicolon/less/equal/greater/question/at/A/B/C/D/E/F/G/H/I/J/K/L/M/N/O
/P/Q/R/S/T/U/V/W/X/Y/Z/bracketleft/backslash/bracketright/circumflex
/underscore/quoteleft/a/b/c/d/e/f/g/h/i/j/k/l/m/n/o/p/q/r/s/t/u/v/w/x/y
/z/braceleft/bar/braceright/tilde/.notdef/quotesinglbase/guillemotleft
/guillemotright/bullet/florin/fraction/perthousand/dagger/daggerdbl
/endash/emdash/ff/fi/fl/ffi/ffl/dotlessi/dotlessj/grave/hungarumlaut
/dotaccent/breve/caron/ring/ogonek/quotedblleft/quotedblright/oe/lslash
/quotedblbase/OE/Lslash/.notdef/exclamdown/cent/sterling/currency/yen
/brokenbar/section/dieresis/copyright/ordfeminine/guilsinglleft
/logicalnot/minus/registered/macron/degree/plusminus/twosuperior
/threesuperior/acute/mu/paragraph/periodcentered/cedilla/onesuperior
/ordmasculine/guilsinglright/onequarter/onehalf/threequarters
/questiondown/Agrave/Aacute/Acircumflex/Atilde/Adieresis/Aring/AE
/Ccedilla/Egrave/Eacute/Ecircumflex/Edieresis/Igrave/Iacute/Icircumflex
/Idieresis/Eth/Ntilde/Ograve/Oacute/Ocircumflex/Otilde/Odieresis
/multiply/Oslash/Ugrave/Uacute/Ucircumflex/Udieresis/Yacute/Thorn
/germandbls/agrave/aacute/acircumflex/atilde/adieresis/aring/ae/ccedilla
/egrave/eacute/ecircumflex/edieresis/igrave/iacute/icircumflex/idieresis
/eth/ntilde/ograve/oacute/ocircumflex/otilde/odieresis/divide/oslash
/ugrave/uacute/ucircumflex/udieresis/yacute/thorn/ydieresis]def
/NewCenturySchlbk-Italic@0 ENC0/NewCenturySchlbk-Italic RE
/NewCenturySchlbk-BoldItalic@0 ENC0/NewCenturySchlbk-BoldItalic RE
/Courier-Elite-Bold@0 ENC0/Courier-Elite-Bold RE/Courier-Elite@0 ENC0
/Courier-Elite RE/NewCenturySchlbk-Roman@0 ENC0/NewCenturySchlbk-Roman
RE/NewCenturySchlbk-Bold@0 ENC0/NewCenturySchlbk-Bold RE
%%EndProlog
%%Page: 1 1
%%BeginPageSetup
BP
%%EndPageSetup
.48 LW 540 54 72 54 DL 540 56 72 56 DL/F0 12/NewCenturySchlbk-Bold@0 SF
(Client/server \212 starter code description)72 50 Q/F1 12
/NewCenturySchlbk-Roman@0 SF 3.336(1o)187.956 G 3.336(f6)-3.336 G/F2 11
/Courier-Elite@0 SF
($Id: asg4-cxi-cxid-code.mm,v 1.60 2022-02-19 18:25:14-08 - - $)72 67 Q
(/afs/cats.ucsc.edu/courses/cse111-wm/Assignments/asg4-client-server)72
80 Q(https://www2.ucsc.edu/courses/cse111-wm/:/Assignments/asg4-client-\
server/)72 93 Q F1(Some code has been provided in several modules)72 117
Q(.)-.3 E F0(1.)72 143 Q/F3 12/Courier-Elite-Bold@0 SF(debug.{h,cpp})
6.888 E F1(As in previous assignments)72 163 Q(.)-.3 E F0(2.)72 189 Q F3
(logstream.h)6.888 E F1 1.553(Is a wrapper for an)72 209 R F3(ostream)
4.888 E F1 1.552(that can be used to print debugging information, but)
4.888 F .536(pre\214xes eac)72 223 R 3.872(ho)-.084 G .536
(utput line with the execname and the process id.)-3.872 F .536
(Since all code is in)7.208 F(the header \214le)72 237 Q 3.336(,a)-.216
G F3(cpp)A F1(\214les is not needed.)3.336 E -1.336(Usage :)72 257 R
(Dec)6.672 E(lare a variable suc)-.084 E 3.336(ha)-.084 G(s)-3.336 E F3
(logstream outlog \(cout\);)3.336 E F1(.)A(Then use it in the same w)72
271 Q .24 -.12(ay a)-.216 H(s).12 E F3(cout)3.336 E F1(:)2 E F3
(outlog <<)85.5 285 Q F1(.....)6 E F3(<< endl;)6 E F1 .1
(The execname and process id \(pid\) via)72 299 R F3(getpid)3.436 E F1
.099(\(2\) is printed followed by whatever else)B
(is to be printed, represented by the ..... above)72 313 Q(.)-.216 E
(The operator)72 333 Q F3(template <typename T>)85.5 347 Q
(ostream& operator<< \(const T& obj\))85.5 361 Q F1 .328
(is a template so that its right operand can be of any type that)72 375
R F3(ostreeam::operator<<)3.665 E F1(can accept as a right operand.)72
389 Q(The \214eld)72 409 Q F3(ostream& out_;)85.5 423 Q F1 1.152
(is a reference)72 437 R 4.488(,n)-.216 G 1.152
(ot a value because objects of type)-4.488 F F3(ostream)4.488 E F1 1.152
(can not be copied.)4.488 F(Note)7.824 E .444
(also that the ctor initializes it by using a \214eld intializer)72 451
R 7.116(.I)-1.2 G 3.78(tc)-7.116 G .444(an not be initialized by)-3.78 F
F3(operator=)72 465 Q F1(inside the body of the ctor)3.336 E(.)-1.2 E 0
Cg EP
%%Page: 2 2
%%BeginPageSetup
BP
%%EndPageSetup
.48 LW 540 54 72 54 DL 540 56 72 56 DL/F0 12/NewCenturySchlbk-Bold@0 SF
(Client/server \212 starter code description)72 50 Q/F1 12
/NewCenturySchlbk-Roman@0 SF 3.336(2o)187.956 G 3.336(f6)-3.336 G F0(3.)
72 74 Q/F2 12/Courier-Elite-Bold@0 SF(protocol.{h,cpp})6.888 E F1 .154
(Implements the protocol that interacts between c)72 94 R .154
(lient and server)-.084 F 6.826(.T)-1.2 G(he)-6.826 E F2(cxi_header)
3.489 E F1(is)3.489 E .356(precisely de\214ned, along with the enum c)72
108 R(lass)-.084 E F2(cxi_commands)3.692 E F1 .356
(to be used in communica-)3.692 F(tion.)72 122 Q(\(a\))81.336 142 Q F2
(static_assert)6 E F1 .484(veri\214es the exact size of the header)102
156 R 3.82(,a)-1.2 G(nd)-3.82 E F2(uint32_t)3.82 E F1 .483
(speci\214es that the count \214eld)3.82 F 1.526(is exactly 32 bits)102
170 R 8.199(.T)-.3 G 1.527(his limits pac)-8.199 F 1.527
(ket size to 4,294,967,296 bytes)-.084 F 4.863(,b)-.3 G 1.527
(ut that is)-4.863 F(more than large enough for a student project.)102
184 Q F2(static_assert)102 204 Q F1 .722
(is determined at compile time and causes the compilation to be)4.059 F
2.282(rejected if its argument is false)102 218 R 8.954(.A)-.216 G(n)
-8.954 E F2(assert)5.619 E F1 5.619(,o)C 5.619(nt)-5.619 G 2.283
(he other hand, is a macro)-5.619 F(whose argument is tested at runtime)
102 232 Q(.)-.216 E(\(b\))81.336 252 Q F2(send_packet)6 E F1 .332
(expects a soc)102 266 R .332(ket and a buffer and loops using the soc)
-.084 F(ket')-.084 E 3.667(ss)-.3 G .331(end until the entire)-3.667 F
(message is sent.)102 280 Q(\(c\))82.68 300 Q F2(recv_packet)6 E F1
1.411(uses soc)102 314 R(ket')-.084 E 4.747(sr)-.3 G 1.411
(ecv and receive a message)-4.747 F 8.083(.I)-.216 G 4.747(ti)-8.083 G
4.748(se)-4.747 G 1.412(xpected that the buffer thus)-4.748 F
(passed in is large enough to accept the message)102 328 Q(.)-.216 E
(\(d\))81.12 348 Q F2(operator<<)6 E F1 1.244
(is for debug printing the header and c)102 362 R(hec)-.084 E 1.243
(king for network or host byte order)-.084 F(errors in the header)102
376 Q(.)-1.2 E/F3 12/NewCenturySchlbk-BoldItalic@0 SF -.396(Wa)72 396 S
-1.444(rning :).396 F F1 3.807
(Some strange errors will occur that will possibly lead to deadloc)
10.478 F(k)-.084 E .765(between the c)72 410 R .765
(lient and the server)-.084 F 4.101(,o)-1.2 G 4.101(ro)-4.101 G .765
(ther strange occurrences)-4.101 F 4.1(,i)-.3 G 4.1(fy)-4.1 G .764
(ou forget to use)-4.1 F F2(ntohl)72 424 Q F1(and)3.336 E F2(htonl)3.336
E F1(when communicating between the c)3.336 E(lient and the server)-.084
E(.)-1.2 E 0 Cg EP
%%Page: 3 3
%%BeginPageSetup
BP
%%EndPageSetup
.48 LW 540 54 72 54 DL 540 56 72 56 DL/F0 12/NewCenturySchlbk-Bold@0 SF
(Client/server \212 starter code description)72 50 Q/F1 12
/NewCenturySchlbk-Roman@0 SF 3.336(3o)187.956 G 3.336(f6)-3.336 G F0(4.)
72 74 Q/F2 12/Courier-Elite-Bold@0 SF(socket.{h,cpp})6.888 E F0<8a>3.444
E F2(base_socket)3.444 E F1 2.901
(Is a wrapper around the more cumbersome standard C interface to soc)72
94 R(kets)-.084 E 9.573(.I)-.3 G(t)-9.573 E 1.611(wraps a soc)72 108 R
1.61(ket \214le descriptor)-.084 F(.)-1.2 E F2(base_socket)8.282 E F1
1.61(de\214nes all of the communication func-)4.946 F(tions)72 122 Q
8.298(.N)-.3 G 4.962(oi)-8.298 G 1.627(nheritance is used, but it is co\
nvenient to separate the user interfaces)-4.962 F
(into separate purposes)72 136 Q(.)-.3 E 1.032
(Most of its functions are)72 156 R F2(protected)4.368 E F1 1.032
(and ma)4.368 F 4.368(yo)-.12 G 1.032(nly be used by the subc)-4.368 F
(lasses)-.084 E 7.704(.S)-.3 G(ince)-7.704 E 1.099
(the ctor and dtor are protected, users are prohibited from dec)72 170 R
1.099(laring a)-.084 F F2(base_socket)4.435 E F1(.)A 2.576
(Program code in the c)72 184 R 2.575
(lient, daemon, and server only dec)-.084 F 2.575
(lare objects of the sub-)-.084 F -.084(cl)72 198 S(asses).084 E(.)-.3 E
(The \214eld values are)72 218 Q(:)2 E(\(a\))81.336 238 Q F2
(int socket_fd)6 E F1
(\214le descriptor \(small integer\) returned by the)102 252 Q F2
(socket)3.336 E F1(system call.)3.336 E(\(b\))81.336 272 Q F2
(sockaddr_in)6 E F1
(containing the connection information for communication.)102 286 Q
(Its \214elds are)6.672 E(:)2 E<83>112.728 300 Q F2
(sa_family_t sin_family)6 E F1 6.672(:a)2 G(ddress family)-6.672 E(:)2 E
F2(AF_INET)6.672 E F1<83>112.728 314 Q F2(in_port_t sin_port)6 E F1
6.672(:n)2 G(et byte order)-6.672 E F2(uint16_t)3.336 E F1(port number)
3.336 E<83>112.728 328 Q F2(struct in_addr sin_addr)6 E F1 6.672(:n)2 G
(et byte order)-6.672 E F2(uint32_t)3.336 E F1(internet address)3.336 E
.875(Since these ha)72 348 R .875
(ve access to operating system facilities)-.12 F 4.211(,t)-.3 G .875
(he copiers and movers ha)-4.211 F(ve)-.12 E(been dec)72 362 Q(lared as)
-.084 E F2(=delete)3.336 E F1(.)A 1.961
(The following functions are inherited by the derived c)72 382 R 1.96
(lasses and ma)-.084 F 5.296(yb)-.12 G 5.296(eu)-5.296 G 1.96(sed by)
-5.296 F 5.44(them. As)72 396 R 2.104(memtioned previously)5.44 F 5.44
(,t)-1.5 G 2.104(he user ma)-5.44 F 5.44(yn)-.12 G 2.105
(ot instantiate this c)-5.44 F 2.105(lass directly)-.084 F(.)-1.5 E
(The a)72 410 Q(vailable functions are)-.12 E(:)2 E(\(a\))81.336 430 Q
F2(void close\(\);)6 E F1 .266(Close the soc)102 444 R 3.602(ket. The)
-.084 F .266(destructor automatically c)3.602 F .266(loses a soc)-.084 F
.266(ket, sot this ma)-.084 F 3.602(yb)-.12 G(e)-3.602 E
(little redundant.)102 458 Q(\(b\))81.336 478 Q F2
(ssize_t send \(const void* buffer, size_t bufsize\);)6 E F1
(Send a message to the soc)102 492 Q
(ket, returning the number of bytes actually sent.)-.084 E(\(c\))82.68
512 Q F2(ssize_t recv \(void* buffer, size_t bufsize\);)6 E F1 2.118
(Receive a message from a buffer of the given size)102 526 R 5.455(,r)
-.216 G 2.119(eporting the number of)-5.455 F(bytes actually received.)
102 540 Q(\(d\))81.12 560 Q F2
(friend string to_string \(const base_socket& sock\);)6 E F1 3.336(Ad)
102 574 S(ebugging format function.)-3.336 E 0 Cg EP
%%Page: 4 4
%%BeginPageSetup
BP
%%EndPageSetup
.48 LW 540 54 72 54 DL 540 56 72 56 DL/F0 12/NewCenturySchlbk-Bold@0 SF
(Client/server \212 starter code description)72 50 Q/F1 12
/NewCenturySchlbk-Roman@0 SF 3.336(4o)187.956 G 3.336(f6)-3.336 G F0(5.)
72 74 Q/F2 12/Courier-Elite-Bold@0 SF(socket.{h,cpp})6.888 E F0 3.444
<8a75>3.444 G(ser interface)-3.444 E F1 .946
(The user interface functions specialize the uses of a base soc)72 94 R
.946(ket for particular pur)-.084 F(-)-.444 E(poses)72 108 Q 6.91(.O)-.3
G .238(nly the constructors differ in the w)-6.91 F .478 -.12(ay t)-.216
H .238(he soc).12 F .239(ket is created.)-.084 F .239(Usage for all of)
6.911 F(the is by send and receive)72 122 Q(.)-.216 E(\(a\))81.336 142 Q
F2(server_socket)6 E F1 2.579
(is used by the daemon, and perhaps should ha)102 156 R 2.579
(ve been named the daemon)-.12 F(soc)102 170 Q(ket instead.)-.084 E 6
<8343>112.728 184 S(reate a soc)-6 E
(ket for communication on a speci\214c server port.)-.084 E 6<8342>
112.728 198 S(ind the soc)-6 E(ket to the speci\214c part.)-.084 E 6
<834c>112.728 212 S(isten for a connection request from a c)-6 E
(lient, whic)-.084 E 3.336(hi)-.084 G 3.336(st)-3.336 G(hen accepted.)
-3.336 E(\(b\))81.336 232 Q F2(accepted_socket)6 E F1 6<8343>112.728 246
S 1.004(reated by a server accepting a call from a c)-6 F 1.004
(lient and used by the server)-.084 F
(sub-process to communicate with a c)126 260 Q(lient.)-.084 E(\(c\))
82.68 280 Q F2(client_socket)6 E F1(is used by a c)102 294 Q
(lient in an attempt to connect to a server)-.084 E(.)-1.2 E 6<8343>
112.728 308 S(reates a soc)-6 E(ket to request the connection.)-.084 E 6
<8341>112.728 322 S(ttempts to connect to a server)-6 E 3.336(,g)-1.2 G
(iven a particular host and port.)-3.336 E 0 Cg EP
%%Page: 5 5
%%BeginPageSetup
BP
%%EndPageSetup
.48 LW 540 54 72 54 DL 540 56 72 56 DL/F0 12/NewCenturySchlbk-Bold@0 SF
(Client/server \212 starter code description)72 50 Q/F1 12
/NewCenturySchlbk-Roman@0 SF 3.336(5o)187.956 G 3.336(f6)-3.336 G F0(6.)
72 74 Q/F2 12/Courier-Elite-Bold@0 SF(cxi.cpp)6.888 E F1 .576(is the c)
72 94 R .575(lient code)-.084 F 7.247(.I)-.216 G 3.911(tr)-7.247 G .575
(eads commands from the input and interprets eac)-3.911 F 3.911(hc)-.084
G(ommand)-3.911 E .119(as needed by sending a pac)72 108 R .119
(ket to the server)-.084 F 6.791(.I)-1.2 G 3.455(th)-6.791 G .119
(as the c)-3.455 F(lient')-.084 E 3.456(sm)-.3 G .12
(ain loop and calls a)-3.456 F(separate function for eac)72 122 Q 3.336
(ho)-.084 G 3.336(ft)-3.336 G(he c)-3.336 E(lient commands)-.084 E(.)-.3
E(\(a\))81.336 142 Q F2(cxi_ls)6 E F1 1.275(example function whic)102
156 R 4.61(hs)-.084 G 1.274(hows to the c)-4.61 F 1.274
(lient interacts with the server)-.084 F 7.946(.I)-1.2 G(mple-)-7.946 E
(ments the)102 170 Q F2(ls)3.336 E F1(command.)3.336 E(\(b\))81.336 190
Q F2(make_unique)6 E F1(The statement)102 204 Q F2
(auto buffer = make_unique<char[]> \(host_nbytes + 1\);)115.5 218 Q F1
.27(creates a)102 232 R F2(unique_ptr)3.606 E F1 .27
(pointing to a buffer of the appropriate size)3.606 F 6.943(.T)-.216 G
.271(his buffer is)-6.943 F .767
(automatically freed when the pointer goes out of scope)102 246 R 7.439
(.T)-.216 G .767(he size of the buffer)-7.439 F .836
(is known in advance)102 260 R 4.172(,h)-.216 G -.12(av)-4.172 G .837
(ing been received in the header).12 F 7.509(.I)-1.2 G 4.173(nt)-7.509 G
.837(he case of load-)-4.173 F(ing a \214le)102 274 Q 3.336(,t)-.216 G
(he)-3.336 E F2(stat)3.336 E F1
(\(2\) system call can determine the size of a \214le)A(.)-.216 E(\(c\))
82.68 294 Q F2(stat)6 E F1(\(2\))A F2(struct stat stat_buf;)115.5 308 Q
(int status = stat \(filename, &stat_buf\);)115.5 322 Q F1 1.714
(will enquire as the the status of the given \214lename)102 336 R 8.385
(.I)-.216 G 5.049(ft)-8.385 G 1.713(he result is 0, then)-5.049 F F2
(stat_buf.st_size)102 350 Q F1 .682
(contains the number of bytes in the \214le)4.017 F 7.354(.N)-.216 G
.682(ote that)-7.354 F F2(filename)4.018 E F1(is a)102 364 Q F2
(const char*)3.336 E F1 3.336(,n)C(ot a)-3.336 E F2(string)3.336 E F1(.)
A 2.664(\(d\) If)81.12 384 R 4.821(as)4.821 G 1.485(ystem call fails)
-4.821 F 4.821(,a)-.3 G 4.821(ne)-4.821 G 1.485
(rror is reported to the standard error in the usual)-4.821 F(manner)102
398 Q 3.336(,a)-1.2 G(nd the exit status for the program is set to)
-3.336 E F2(EXIT_FAILURE)3.336 E F1(.)A/F3 12/NewCenturySchlbk-Italic@0
SF(execname: \214lename: reason)102 412 Q F1<83>112.728 426 Q F3
(execname)6 E F1 .011(is alw)3.346 F -.12(ay)-.216 G 3.347(st).12 G(he)
-3.347 E F2(basename)3.347 E F1 .011
(\(3\) of the program being run \(derived from)B F2(argv[0])126 440 Q F1
(\).)A<83>112.728 454 Q F3(\214lename)6 E F1
(is the name of the \214le or other object that could not be accessed.)
3.336 E<83>112.728 468 Q F3(reason)6 E F1
(is the explanation of the problem from)3.336 E F2(strerror\(errno\).)
3.336 E 0 Cg EP
%%Page: 6 6
%%BeginPageSetup
BP
%%EndPageSetup
.48 LW 540 54 72 54 DL 540 56 72 56 DL/F0 12/NewCenturySchlbk-Bold@0 SF
(Client/server \212 starter code description)72 50 Q/F1 12
/NewCenturySchlbk-Roman@0 SF 3.336(6o)187.956 G 3.336(f6)-3.336 G F0(7.)
72 74 Q/F2 12/Courier-Elite-Bold@0 SF(cxid.cpp)6.888 E F0 3.444<8a64>
3.444 G(aemon)-3.444 E F1 1.662(Is both the daemon and server code in o\
ne program, but multiple processes)72 94 R 8.333(.T)-.3 G(he)-8.333 E
2.919(daemon creates a)72 108 R F2(server_socket)6.255 E F1(whic)6.255 E
6.255(hi)-.084 G 6.255(su)-6.255 G 2.919(sed to listen for a c)-6.255 F
2.919(lient connection.)-.084 F 2.684(When a c)72 122 R 2.684
(lient connects)-.084 F(,)-.3 E F2(fork)6.02 E F1 2.684
(\(2\) is used to create a c)B 2.683(hild process to execute the)-.084 F
1.42(server code)72 136 R 8.092(.I)-.216 G 4.756(ta)-8.092 G 1.42
(lso reaps zombie processes whic)-4.756 F 4.757(ha)-.084 G 1.421
(re servers from whic)-4.757 F 4.757(hac)-.084 G(lient)-4.841 E
(has disconnected.)72 150 Q(There is a separate server process for eac)
6.672 E 3.336(hc)-.084 G(lient that connects)-3.42 E(.)-.3 E(\(a\))
81.336 170 Q F2(main)6 E F1 1.454
(The main function sets up a signal action and a server soc)102 184 R
1.453(ket to listen for a)-.084 F -.084(cl)102 198 S 6.049
(ient. Whenever).084 F 6.049(ac)6.049 G 2.713(lient connects)-6.133 F
6.049(,i)-.3 G 6.049(tf)-6.049 G 2.713(orks a c)-6.049 F 2.713
(hild process to preform the)-.084 F(server task.)102 212 Q
(It is an in\214nite loop and will run until killed at the terminal.)
6.672 E(\(b\))81.336 232 Q F2(reap_zombies)6 E F1 .481(when a c)102 246
R .481(hild process exits)-.084 F 3.817(,i)-.3 G 3.817(tb)-3.817 G .481
(ecomes a zombie until the parent w)-3.817 F .48(aits for it or)-.216 F
1.081(until the parent exits)102 260 R 7.753(.B)-.3 G 1.082
(ut the daemon is in an in\214nite loop)-7.753 F 4.418(,s)-.216 G 4.418
(oi)-4.418 G 4.418(tu)-4.418 G(ses)-4.418 E F2(wait-)4.418 E(pid)102 274
Q F1 .72(\(2\) to report the status of the c)B .72(hild process)-.084 F
4.056(,t)-.3 G .72(hus removing the c)-4.056 F .72(hild server)-.084 F
(from the process table)102 288 Q(.)-.216 E(\(c\))82.68 308 Q F2
(fork_cxiserver)6 E F1(Use)102 322 Q F2(fork)4.179 E F1 .843
(\(2\) to run the server)B 7.515(.I)-1.2 G 4.179(tm)-7.515 G .843(ust c)
-4.179 F .844(lose the unused soc)-.084 F .844(kets \(the server in)
-.084 F(the c)102 336 Q(hild and the accepted soc)-.084 E
(ket in the parent\).)-.084 E F0(8.)72 362 Q F2(cxid.cpp)6.888 E F0
3.444<8a73>3.444 G(erver)-3.444 E F1 .064
(contains the run_server process)72 382 R 3.399(,w)-.3 G(hic)-3.399 E
3.399(hl)-.084 G .063(oops reading commands from the c)-3.399 F .063
(lient, act-)-.084 F .64(ing on those commands)72 396 R 3.976(,t)-.3 G
.64(hen sending bac)-3.976 F 3.976(kar)-.084 G(eply)-3.976 E 7.312(.I)
-1.5 G 3.976(tr)-7.312 G .64(uns in an in\214nite loop)-3.976 F 3.976
(,e)-.216 G(xit-)-3.976 E(ing only when the c)72 410 Q
(lient disconnects)-.084 E(.)-.3 E(\(a\))81.336 430 Q F2(run_server)6 E
F1 .66(is the c)102 444 R .66(hild process that w)-.084 F .66
(aits for a command from the c)-.216 F .66(lient and then replies)-.084
F 2.24(as appropriate)102 458 R 8.912(.I)-.216 G 5.576(tc)-8.912 G 2.241
(ontinues until the c)-5.576 F 2.241(lient disconnects)-.084 F 5.577(,a)
-.3 G 5.577(tw)-5.577 G(hic)-5.577 E 5.577(ht)-.084 G 2.241(ime the)
-5.577 F(server exits)102 472 Q(.)-.3 E(\(b\))81.336 492 Q F2(reply_ls)6
E F1 1.217(is an example of how to reply to a c)102 506 R 4.553
(lient. It)-.084 F(uses)4.553 E F2(popen)4.553 E F1 1.217
(\(3\) to create a pipe to)B F2(ls)102 520 Q F1 .459
(\(1\) to list the \214les in the server')B 3.795(sd)-.3 G(irectory)
-3.795 E 7.132(.T)-1.5 G .46(hen it sends the information to)-7.132 F
(the c)102 534 Q(lient.)-.084 E 0 Cg EP
%%Trailer
end
%%EOF
